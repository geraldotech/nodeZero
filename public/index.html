<!DOCTYPE html>
<html lang="en" style="color-scheme: dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Page</title>
    <style>
      section input[value] {
        background: gray;
        border: 1px solid;
        width: max-content;
      }
      button {
        margin: 20px 0;
      }
    </style>
  </head>
  <body>
    <h1>Method: POST</h1>
    <form id="sendpost">
      <input
        type="text"
        value="Post from Post Ajax"
        name="title"
        placeholder="title"
      />
      <input
        type="text"
        value="loremipsum is a new way to"
        name="description"
        placeholder="description"
        id="title"
      />
      <input type="text" value="200" name="duration" id="title" />
      <input type="submit" value="Send Post" />
    </form>
    <hr />
    <button>Direct Post</button>
    <script>
      //const BASE = `http://localhost:3333/videos`
      const BASE = `https://node-do-zerp.onrender.com/videos`
      //const BASE = `https://node-zero.vercel.app/videos`

      async function getvideos(url) {
        const req = await fetch(url)
        const res = await req.json()
        console.warn('dados from:', res)
        Render(res)
      }

      function Render(data) {
        data.forEach((value) => {
          const h2 = document.createElement('h2')
          const section = document.createElement('section').cloneNode()

          h2.innerText = value.title
          section.innerHTML = `ID:<input value="${value.id}" onFocus="this.select()" /> - Description: ${value.description} - Duration: ${value.duration}`
          document.body.append(section)
          document.body.append(h2)
        })
      }

      getvideos(BASE)

      //post scratch
      const baseURL2 = `https://node-do-zerp.onrender.com/videos`
      const post = {
        title: 'JavaScript Arrays and String Methods',
        description: 'Esse Ã© o primeiro video',
        duration: 204,
      }

      const btn = document.querySelector('button')
      btn.onclick = function (event) {
        //event.preventDefault();
        const ajaxn = new XMLHttpRequest()
        ajaxn.open('POST', baseURL2)
        ajaxn.setRequestHeader('content-Type', 'application/json')
        const json = JSON.stringify(post)
        //const json = JSON.stringify(Object.fromEntries(post))
        console.error(post)
        ajaxn.send(json)
      }
      //post scratch ends

      //post from form
      const form = document.querySelector('#sendpost')
      form.onsubmit = function (event) {
        event.preventDefault()
        const data = new FormData(form)
        const dataobj = Object.fromEntries(data)
        postDataToServer(dataobj)
      }

      function postDataToServer(FormObj) {
        //event.preventDefault();
        const ajaxn = new XMLHttpRequest()
        ajaxn.open('POST', baseURL2)
        ajaxn.setRequestHeader('content-Type', 'application/json')
        const json = JSON.stringify(FormObj)
        //const json = JSON.stringify(Object.fromEntries(post))
        console.warn(FormObj)
        ajaxn.send(FormObj)
      }
    </script>
  </body>
</html>
